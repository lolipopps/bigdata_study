#### HBase 的一致性

强一致性

```
每个值只出现在一个 region。
同一时间每个 region 只被分配给一个 region server。
所有行内的 mutation 操作都是原子操作。
通过任何 API 返回的行的内容总是一个完整的行。
```

自动分片
RegionServer 自动故障转移
Block Cache 和 Bloom Filter


强一致性（Strong Consistency） 强一致性是 HBase 的默认一致性模型。

时间轴一致性（Timeline Consistency）
时间轴一致性的读请求的返回结果可能不包括最近更新的数据，即 get 和 scan 可能包括过期数据。

CAP定理指出对于一个分布式系统而言，不可能同时满足以下三点：

* 一致性（Consistence）
* 可用性（Availability）
* 网络分区容忍性（Partition tolerance）


对于分布式系统而言，分区容忍性是基本要求，所以在设计分布式数据系统时，需要在一致性和可用性中做权衡，但无论如何做权衡，都无法完全放弃一致性，
如果真的放弃一致性，那么这个系统中的数据就变得不可信了。一般而言，分布式数据系统会牺牲部分一致性，使用最终一致性。
```
强一致性：当更新操作完成后，之后任意进程任何时间的请求的返回值都是一致的。
弱一致性：更新完成后，系统并不保证后续请求的返回值是一致的（更新前和更新后的值都可能被返回），也不保证过多久返回的值一致。
最终一致性：更新完成后，在“不一致窗口”后的请求的返回值都是一致。最终一致性是弱一致性的特例。
```

#### WAL

为了避免服务器掉电丢失 Memstore 的数据，数据最先写入的是 WAL，然后才是 Memstore。WAL 的角色类似 Mysql 中的 Binlog，在 Memstore 数据丢失时，可用 WAL 来恢复数据。